<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;12.&nbsp;HBase Operational Management</title><link rel="stylesheet" type="text/css" href="../css/freebsd_docbook.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="book.html" title=""><link rel="up" href="book.html" title=""><link rel="prev" href="trouble.ec2.html" title="11.9.&nbsp;Amazon EC2"><link rel="next" href="node.management.html" title="12.2.&nbsp;Node Management"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;12.&nbsp;HBase Operational Management</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="trouble.ec2.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="node.management.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter&nbsp;12.&nbsp;HBase Operational Management"><div class="titlepage"><div><div><h2 class="title"><a name="ops_mgt"></a>Chapter&nbsp;12.&nbsp;HBase Operational Management</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ops_mgt.html#tools">12.1. HBase Tools and Utilities</a></span></dt><dd><dl><dt><span class="section"><a href="ops_mgt.html#hbck">12.1.1. HBase <span class="application">hbck</span></a></span></dt><dt><span class="section"><a href="ops_mgt.html#hfile_tool2">12.1.2. HFile Tool</a></span></dt><dt><span class="section"><a href="ops_mgt.html#wal_tools">12.1.3. WAL Tools</a></span></dt><dt><span class="section"><a href="ops_mgt.html#compression.tool">12.1.4. Compression Tool</a></span></dt><dt><span class="section"><a href="ops_mgt.html#copytable">12.1.5. CopyTable</a></span></dt><dt><span class="section"><a href="ops_mgt.html#export">12.1.6. Export</a></span></dt><dt><span class="section"><a href="ops_mgt.html#import">12.1.7. Import</a></span></dt><dt><span class="section"><a href="ops_mgt.html#rowcounter">12.1.8. RowCounter</a></span></dt></dl></dd><dt><span class="section"><a href="node.management.html">12.2. Node Management</a></span></dt><dd><dl><dt><span class="section"><a href="node.management.html#decommission">12.2.1. Node Decommission</a></span></dt><dt><span class="section"><a href="node.management.html#rolling">12.2.2. Rolling Restart</a></span></dt></dl></dd><dt><span class="section"><a href="hbase_metrics.html">12.3. Metrics</a></span></dt><dd><dl><dt><span class="section"><a href="hbase_metrics.html#metric_setup">12.3.1. Metric Setup</a></span></dt><dt><span class="section"><a href="hbase_metrics.html#rs_metrics">12.3.2. RegionServer Metrics</a></span></dt></dl></dd><dt><span class="section"><a href="ops.monitoring.html">12.4. HBase Monitoring</a></span></dt><dt><span class="section"><a href="cluster_replication.html">12.5. Cluster Replication</a></span></dt><dt><span class="section"><a href="ops.backup.html">12.6. HBase Backup</a></span></dt><dd><dl><dt><span class="section"><a href="ops.backup.html#ops.backup.fullshutdown">12.6.1. Full Shutdown Backup</a></span></dt><dt><span class="section"><a href="ops.backup.html#ops.backup.live.replication">12.6.2. Live Cluster Backup - Replication</a></span></dt><dt><span class="section"><a href="ops.backup.html#ops.backup.live.copytable">12.6.3. Live Cluster Backup - CopyTable</a></span></dt><dt><span class="section"><a href="ops.backup.html#ops.backup.live.export">12.6.4. Live Cluster Backup - Export</a></span></dt></dl></dd><dt><span class="section"><a href="ops.capacity.html">12.7. Capacity Planning</a></span></dt><dd><dl><dt><span class="section"><a href="ops.capacity.html#ops.capacity.storage">12.7.1. Storage</a></span></dt><dt><span class="section"><a href="ops.capacity.html#ops.capacity.regions">12.7.2. Regions</a></span></dt></dl></dd></dl></div>
  This chapter will cover operational tools and practices required of a running HBase cluster.
  The subject of operations is related to the topics of <a class="xref" href="trouble.html" title="Chapter&nbsp;11.&nbsp;Troubleshooting and Debugging HBase">Chapter&nbsp;11, <i>Troubleshooting and Debugging HBase</i></a>, <a class="xref" href="performance.html" title="Chapter&nbsp;10.&nbsp;Performance Tuning">Chapter&nbsp;10, <i>Performance Tuning</i></a>,
  and <a class="xref" href="configuration.html" title="Chapter&nbsp;2.&nbsp;Configuration">Chapter&nbsp;2, <i>Configuration</i></a> but is a distinct topic in itself.  
  
  <div class="section" title="12.1.&nbsp;HBase Tools and Utilities"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tools"></a>12.1.&nbsp;HBase Tools and Utilities</h2></div></div></div><p>Here we list HBase tools for administration, analysis, fixup, and
    debugging.</p><div class="section" title="12.1.1.&nbsp;HBase hbck"><div class="titlepage"><div><div><h3 class="title"><a name="hbck"></a>12.1.1.&nbsp;HBase <span class="application">hbck</span></h3></div><div><h4 class="subtitle">An <span class="emphasis"><em>fsck</em></span> for your HBase install</h4></div></div></div><p>To run <span class="application">hbck</span> against your HBase cluster run
        </p><pre class="programlisting">$ ./bin/hbase hbck</pre><p>
        At the end of the commands output it prints <span class="emphasis"><em>OK</em></span>
        or <span class="emphasis"><em>INCONSISTENCY</em></span>. If your cluster reports
        inconsistencies, pass <span class="command"><strong>-details</strong></span> to see more detail emitted.
        If inconsistencies, run <span class="command"><strong>hbck</strong></span> a few times because the
        inconsistency may be transient (e.g. cluster is starting up or a region is
        splitting).
        Passing <span class="command"><strong>-fix</strong></span> may correct the inconsistency (This latter
        is an experimental feature).
        </p></div><div class="section" title="12.1.2.&nbsp;HFile Tool"><div class="titlepage"><div><div><h3 class="title"><a name="hfile_tool2"></a>12.1.2.&nbsp;HFile Tool</h3></div></div></div><p>See <a class="xref" href="regions.arch.html#hfile_tool" title="8.6.4.2.2.&nbsp;HFile Tool">Section&nbsp;8.6.4.2.2, &#8220;HFile Tool&#8221;</a>.</p></div><div class="section" title="12.1.3.&nbsp;WAL Tools"><div class="titlepage"><div><div><h3 class="title"><a name="wal_tools"></a>12.1.3.&nbsp;WAL Tools</h3></div></div></div><div class="section" title="12.1.3.1.&nbsp;HLog tool"><div class="titlepage"><div><div><h4 class="title"><a name="hlog_tool"></a>12.1.3.1.&nbsp;<code class="classname">HLog</code> tool</h4></div></div></div><p>The main method on <code class="classname">HLog</code> offers manual
        split and dump facilities. Pass it WALs or the product of a split, the
        content of the <code class="filename">recovered.edits</code>. directory.</p><p>You can get a textual dump of a WAL file content by doing the
        following:</p><pre class="programlisting"> <code class="code">$ ./bin/hbase org.apache.hadoop.hbase.regionserver.wal.HLog --dump hdfs://example.org:8020/hbase/.logs/example.org,60020,1283516293161/10.10.21.10%3A60020.1283973724012</code> </pre><p>The
        return code will be non-zero if issues with the file so you can test
        wholesomeness of file by redirecting <code class="varname">STDOUT</code> to
        <code class="code">/dev/null</code> and testing the program return.</p><p>Similarily you can force a split of a log file directory by
        doing:</p><pre class="programlisting"> $ ./<code class="code">bin/hbase org.apache.hadoop.hbase.regionserver.wal.HLog --split hdfs://example.org:8020/hbase/.logs/example.org,60020,1283516293161/</code></pre></div></div><div class="section" title="12.1.4.&nbsp;Compression Tool"><div class="titlepage"><div><div><h3 class="title"><a name="compression.tool"></a>12.1.4.&nbsp;Compression Tool</h3></div></div></div><p>See <a class="xref" href="ops_mgt.html#compression.tool" title="12.1.4.&nbsp;Compression Tool">Section&nbsp;12.1.4, &#8220;Compression Tool&#8221;</a>.</p></div><div class="section" title="12.1.5.&nbsp;CopyTable"><div class="titlepage"><div><div><h3 class="title"><a name="copytable"></a>12.1.5.&nbsp;CopyTable</h3></div></div></div><p>
            CopyTable is a utility that can copy part or of all of a table, either to the same cluster or another cluster. The usage is as follows:
</p><pre class="programlisting">$ bin/hbase org.apache.hadoop.hbase.mapreduce.CopyTable [--rs.class=CLASS] [--rs.impl=IMPL] [--starttime=X] [--endtime=Y] [--new.name=NEW] [--peer.adr=ADR] tablename
</pre><p>
        </p><p>
        Options:
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="varname">rs.class</code> hbase.regionserver.class of the peer cluster.  Specify if different from current cluster.</li><li class="listitem"><code class="varname">rs.impl</code>  hbase.regionserver.impl of the peer cluster. </li><li class="listitem"><code class="varname">starttime</code>  Beginning of the time range.  Without endtime means starttime to forever.</li><li class="listitem"><code class="varname">endtime</code>  End of the time range.  Without endtime means starttime to forever.</li><li class="listitem"><code class="varname">new.name</code>  New table's name.</li><li class="listitem"><code class="varname">peer.adr</code>  Address of the peer cluster given in the format hbase.zookeeper.quorum:hbase.zookeeper.client.port:zookeeper.znode.parent</li><li class="listitem"><code class="varname">families</code>  Comma-separated list of ColumnFamilies to copy.</li></ul></div><p>
         Args:
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">tablename  Name of table to copy.</li></ul></div><p>
        </p><p>Example of copying 'TestTable' to a cluster that uses replication for a 1 hour window:
</p><pre class="programlisting">$ bin/hbase org.apache.hadoop.hbase.mapreduce.CopyTable
--rs.class=org.apache.hadoop.hbase.ipc.ReplicationRegionInterface
--rs.impl=org.apache.hadoop.hbase.regionserver.replication.ReplicationRegionServer
--starttime=1265875194289 --endtime=1265878794289
--peer.adr=server1,server2,server3:2181:/hbase TestTable</pre><p>
        </p></div><div class="section" title="12.1.6.&nbsp;Export"><div class="titlepage"><div><div><h3 class="title"><a name="export"></a>12.1.6.&nbsp;Export</h3></div></div></div><p>Export is a utility that will dump the contents of table to HDFS in a sequence file.  Invoke via:
</p><pre class="programlisting">$ bin/hbase org.apache.hadoop.hbase.mapreduce.Export &lt;tablename&gt; &lt;outputdir&gt; [&lt;versions&gt; [&lt;starttime&gt; [&lt;endtime&gt;]]]
</pre><p>
       </p></div><div class="section" title="12.1.7.&nbsp;Import"><div class="titlepage"><div><div><h3 class="title"><a name="import"></a>12.1.7.&nbsp;Import</h3></div></div></div><p>Import is a utility that will load data that has been exported back into HBase.  Invoke via:
</p><pre class="programlisting">$ bin/hbase org.apache.hadoop.hbase.mapreduce.Import &lt;tablename&gt; &lt;inputdir&gt;
</pre><p>
       </p></div><div class="section" title="12.1.8.&nbsp;RowCounter"><div class="titlepage"><div><div><h3 class="title"><a name="rowcounter"></a>12.1.8.&nbsp;RowCounter</h3></div></div></div><p>RowCounter is a utility that will count all the rows of a table.  This is a good utility to use
       as a sanity check to ensure that HBase can read all the blocks of a table if there are any concerns of metadata inconsistency.
</p><pre class="programlisting">$ bin/hbase org.apache.hadoop.hbase.mapreduce.RowCounter &lt;tablename&gt; [&lt;column1&gt; &lt;column2&gt;...]
</pre><p>
       </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="trouble.ec2.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="node.management.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">11.9.&nbsp;Amazon EC2&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;12.2.&nbsp;Node Management</td></tr></table></div></body></html>